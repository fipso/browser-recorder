<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Video Player</title>
    <link rel="stylesheet" href="styles/shared.css" />
    <link rel="stylesheet" href="styles/player.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
    <style>
      /* Debug mode specific styles */
      .debug-toggle {
        position: fixed;
        bottom: 10px;
        right: 10px;
        display: flex;
        align-items: center;
        gap: 8px;
        background: #1e293b;
        padding: 8px 12px;
        border-radius: 6px;
        font-size: 12px;
        color: #cbd5e1;
        cursor: pointer;
        user-select: none;
        z-index: 1000;
        border: 1px solid #334155;
      }

      .debug-toggle:hover {
        background: #334155;
      }

      .debug-toggle input[type='checkbox'] {
        cursor: pointer;
        width: 14px;
        height: 14px;
      }

      .debug-hidden {
        display: none !important;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header-left">
        <img src="./icons/logo.png" alt="Browser Recorder" />
        <h1>Browser Recorder</h1>
      </div>
      <div class="main-content">
        <div class="video-container" id="videoContainer">
          <div class="no-video" id="noVideo">
            <h2>No Recording Available</h2>
            <p>Record a video first using the recorder interface.</p>
          </div>
          <canvas id="videoCanvas" class="hidden"></canvas>
        </div>

        <!-- Hidden video element for frame extraction -->
        <video id="hiddenVideo"></video>
      </div>

      <div class="timeline-editor">
        <div class="timeline-controls">
          <div class="timeline-control">
            <button id="playPauseBtn" class="play-pause-btn" disabled>
              <h1 id="playPauseIcon">‚ñ∂</h1>
            </button>

            <div class="timeline-time-display">
              <div class="time-display">
                <h3 id="currentTime">00:00</h3>
              </div>
              /
              <div class="time-display">
                <h3 id="duration">00:00</h3>
              </div>
            </div>
          </div>

          <div class="timeline-control">
            <div class="volume-control">
              <span>
                <h1 class="bi bi-volume-up-fill"></h1>
              </span>
              <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="100" />
            </div>
          </div>

          <div class="timeline-control">
            <div class="speed-control">
              <label for="speedSelect">
                <h1 class="bi bi-speedometer"></h1>
              </label>
              <select id="speedSelect">
                <option value="0.25">0.25x</option>
                <option value="0.5">0.5x</option>
                <option value="0.75">0.75x</option>
                <option value="1" selected>1x</option>
                <option value="1.25">1.25x</option>
                <option value="1.5">1.5x</option>
                <option value="2">2x</option>
              </select>
            </div>
          </div>

          <div class="timeline-control">
            <!-- Export Settings -->
            <div class="export-settings-inline">
              <label for="exportFps">FPS:</label>
              <select id="exportFps">
                <option value="24">24</option>
                <option value="30" selected>30</option>
                <option value="60">60</option>
              </select>
            </div>
          </div>

          <div class="timeline-control">
            <div class="export-settings-inline">
              <label for="exportBitrate">Quality:</label>
              <select id="exportBitrate">
                <option value="2500000">2.5</option>
                <option value="5000000" selected>5</option>
                <option value="8000000">8</option>
                <option value="10000000">10</option>
              </select>
            </div>
          </div>

          <div class="button-actions">
            <button id="exportBtn" class="export-btn" disabled>
              <h1 class="bi bi-film"></h1>
            </button>

            <button id="deleteBtn" class="delete-btn" disabled>
              <h1 class="bi bi-trash3-fill"></h1>
            </button>

            <button id="downloadBtn" class="download-btn" disabled>
              <h1 class="bi bi-cloud-download-fill"></h1>
            </button>
          </div>
        </div>

        <div class="timeline-controls">
          <button class="add-zoom-btn" id="addZoomBtn">+ Add Zoom Effect</button>
          <div class="info-text" id="infoText">Load a recording to start playing.</div>
          <div class="debug-info" id="debugInfo"></div>
        </div>

        <!-- Effect Properties Panel -->
        <div class="effect-properties" id="effectProperties" style="display: none">
          <h4>Effect Properties</h4>
          <div class="property-group">
            <label for="zoomStrength">Zoom Strength:</label>
            <div class="property-control">
              <input type="range" id="zoomStrength" min="1.5" max="4" step="0.1" value="2" />
              <span id="zoomStrengthValue">2.0x</span>
            </div>
          </div>
          <div class="property-group">
            <label for="zoomMode">Zoom Mode:</label>
            <select id="zoomMode">
              <option value="follow">Follow Cursor</option>
              <option value="manual">Manual Position</option>
            </select>
          </div>
          <div class="property-group manual-mode-only" id="manualPositionGroup" style="display: none">
            <label>Zoom Position:</label>
            <div class="manual-position-hint">üìç Click on the video to set zoom position</div>
            <div class="property-control-grid">
              <div>
                <label for="manualX">X:</label>
                <input type="number" id="manualX" min="0" max="100" value="50" readonly />
              </div>
              <div>
                <label for="manualY">Y:</label>
                <input type="number" id="manualY" min="0" max="100" value="50" readonly />
              </div>
            </div>
          </div>
          <button id="deleteEffectBtn" class="delete-effect-btn">Delete Effect</button>
        </div>

        <span id="debug-consoles" class="hidden">
          <div class="debug-panel" id="debugPanel"></div>
          <div class="debug-panel debug-hidden" id="cursorOffsetPanel">
            <h4>Cursor Timing Adjustment</h4>
            <div style="display: flex; align-items: center; gap: 10px; margin-top: 10px">
              <label for="cursorOffset">Offset (seconds):</label>
              <input type="range" id="cursorOffset" min="-2" max="2" step="0.1" value="0" style="flex: 1" />
              <span id="cursorOffsetValue">0.0s</span>
            </div>
            <div style="margin-top: 5px; font-size: 10px; color: #64748b">
              Adjust if cursor is ahead (+) or behind (-) the video
            </div>
          </div>
        </span>
        <div class="timeline-track" id="timelineTrack">
          <div class="timeline-scale" id="timelineScale"></div>
          <div class="timeline-content">
            <div class="playhead" id="playhead">
              <div class="playhead-handle" id="playheadHandle">
                <div class="playhead-time" id="playheadTime">00:00</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <span id="debug-consoles" class="hidden">
      <label class="debug-toggle">
        <input type="checkbox" id="debugModeToggle" />
        Debug Mode
      </label>
    </span>
    <script src="player.js"></script>
  </body>
</html>
